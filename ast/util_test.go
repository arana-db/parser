// Copyright 2017 PingCAP, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// See the License for the specific language governing permissions and
// limitations under the License.

package ast_test

import (
	"fmt"
	"strings"
	"testing"

	"github.com/arana-db/parser"
	. "github.com/arana-db/parser/ast"
	. "github.com/arana-db/parser/format"
	"github.com/arana-db/parser/test_driver"
	"github.com/stretchr/testify/require"
)

func TestXxx(t *testing.T) {
	yySymNames := []string{
		"$end",
		"';'",
		"split",
		"merge",
		"remove",
		"reorganize",
		"comment",
		"storage",
		"autoIncrement",
		"','",
		"first",
		"after",
		"serial",
		"autoRandom",
		"columnFormat",
		"password",
		"charsetKwd",
		"checksum",
		"placement",
		"keyBlockSize",
		"tablespace",
		"encryption",
		"engine",
		"data",
		"insertMethod",
		"maxRows",
		"minRows",
		"nodegroup",
		"connection",
		"autoRandomBase",
		"statsBuckets",
		"statsTopN",
		"ttl",
		"autoIdCache",
		"avgRowLength",
		"compression",
		"delayKeyWrite",
		"packKeys",
		"preSplitRegions",
		"rowFormat",
		"secondaryEngine",
		"shardRowIDBits",
		"statsAutoRecalc",
		"statsColChoice",
		"statsColList",
		"statsPersistent",
		"statsSamplePages",
		"statsSampleRate",
		"tableChecksum",
		"ttlEnable",
		"resource",
		"attribute",
		"account",
		"failedLoginAttempts",
		"passwordLockTime",
		"resume",
		"signed",
		"snapshot",
		"')'",
		"backend",
		"checkpoint",
		"concurrency",
		"csvBackslashEscape",
		"csvDelimiter",
		"csvHeader",
		"csvNotNull",
		"csvNull",
		"csvSeparator",
		"csvTrimLastSeparators",
		"lastBackup",
		"onDuplicate",
		"online",
		"rateLimit",
		"sendCredentialsToTiKV",
		"skipSchemaFiles",
		"strictFormat",
		"tikvImporter",
		"truncate",
		"no",
		"start",
		"cache",
		"nocache",
		"cycle",
		"minValue",
		"increment",
		"nocycle",
		"nomaxvalue",
		"nominvalue",
		"restart",
		"algorithm",
		"tp",
		"clustered",
		"invisible",
		"nonclustered",
		"regions",
		"visible",
		"subpartition",
		"partitions",
		"constraints",
		"followerConstraints",
		"followers",
		"leaderConstraints",
		"learnerConstraints",
		"learners",
		"primaryRegion",
		"schedule",
		"voterConstraints",
		"voters",
		"columns",
		"view",
		"day",
		"yearType",
		"second",
		"sqlTsiYear",
		"ascii",
		"byteType",
		"cpu",
		"hour",
		"microsecond",
		"minute",
		"month",
		"quarter",
		"sqlTsiDay",
		"sqlTsiHour",
		"sqlTsiMinute",
		"sqlTsiMonth",
		"sqlTsiQuarter",
		"sqlTsiSecond",
		"sqlTsiWeek",
		"unicodeSym",
		"week",
		"fields",
		"ioReadBandwidth",
		"ioWriteBandwidth",
		"rruRate",
		"tables",
		"wruRate",
		"status",
		"separator",
		"cipher",
		"identifier",
		"issuer",
		"maxConnectionsPerHour",
		"maxQueriesPerHour",
		"maxUpdatesPerHour",
		"maxUserConnections",
		"preceding",
		"san",
		"subject",
		"tokenIssuer",
		"importKwd",
		"local",
		"query",
		"skip",
		"bindings",
		"definer",
		"hash",
		"identified",
		"logs",
		"respect",
		"commit",
		"current",
		"enforced",
		"following",
		"less",
		"nowait",
		"only",
		"rollback",
		"savepoint",
		"than",
		"unbounded",
		"value",
		"begin",
		"binding",
		"end",
		"global",
		"next_row_id",
		"offset",
		"policy",
		"predicate",
		"temporary",
		"tiFlash",
		"user",
		"jsonType",
		"planCache",
		"prepare",
		"role",
		"unknown",
		"wait",
		"btree",
		"datetimeType",
		"dateType",
		"fixed",
		"identSQLErrors",
		"isolation",
		"last",
		"location",
		"max_idxnum",
		"memory",
		"off",
		"optional",
		"per_db",
		"plan",
		"privileges",
		"replica",
		"required",
		"rtree",
		"running",
		"sampleRate",
		"sequence",
		"session",
		"slow",
		"stats",
		"timeType",
		"validation",
		"variables",
		"attributes",
		"compact",
		"digest",
		"disable",
		"duplicate",
		"dynamic",
		"enable",
		"errorKwd",
		"flush",
		"full",
		"history",
		"mb",
		"mode",
		"plugins",
		"processlist",
		"recover",
		"repair",
		"repeatable",
		"statistics",
		"subpartitions",
		"tidb",
		"timestampType",
		"without",
		"admin",
		"backup",
		"batch",
		"binlog",
		"block",
		"booleanType",
		"briefType",
		"buckets",
		"capture",
		"cardinality",
		"chain",
		"clientErrorsSummary",
		"cmSketch",
		"coalesce",
		"compressed",
		"context",
		"copyKwd",
		"correlation",
		"deallocate",
		"dependency",
		"directory",
		"discard",
		"disk",
		"do",
		"dotType",
		"drainer",
		"dry",
		"exchange",
		"execute",
		"expansion",
		"flashback",
		"format",
		"general",
		"help",
		"histogram",
		"hosts",
		"inplace",
		"instance",
		"instant",
		"ipc",
		"job",
		"jobs",
		"labels",
		"locked",
		"modify",
		"next",
		"nodeID",
		"nodeState",
		"nulls",
		"pageSym",
		"pump",
		"purge",
		"rebuild",
		"redundant",
		"reload",
		"restore",
		"routine",
		"s3",
		"samples",
		"secondaryLoad",
		"secondaryUnload",
		"share",
		"shutdown",
		"source",
		"statsOptions",
		"stop",
		"swaps",
		"tidbJson",
		"tokudbDefault",
		"tokudbFast",
		"tokudbLzma",
		"tokudbQuickLZ",
		"tokudbSmall",
		"tokudbSnappy",
		"tokudbUncompressed",
		"tokudbZlib",
		"tokudbZstd",
		"topn",
		"trace",
		"traditional",
		"trueCardCost",
		"verboseType",
		"warnings",
		"action",
		"advise",
		"against",
		"ago",
		"always",
		"backups",
		"bernoulli",
		"bindingCache",
		"bitType",
		"boolType",
		"builtins",
		"cancel",
		"cascaded",
		"causal",
		"cleanup",
		"client",
		"cluster",
		"collation",
		"columnStatsUsage",
		"committed",
		"config",
		"consistency",
		"consistent",
		"ddl",
		"depth",
		"disabled",
		"dump",
		"enabled",
		"engines",
		"enum",
		"events",
		"evolve",
		"expire",
		"exprPushdownBlacklist",
		"extended",
		"faultsSym",
		"function",
		"grants",
		"histogramsInFlight",
		"imports",
		"incremental",
		"indexes",
		"internal",
		"invoker",
		"io",
		"language",
		"level",
		"list",
		"master",
		"max_minutes",
		"national",
		"ncharType",
		"never",
		"nextval",
		"none",
		"nvarcharType",
		"open",
		"optimistic",
		"optRuleBlacklist",
		"parser",
		"partial",
		"partitioning",
		"per_table",
		"percent",
		"pessimistic",
		"preserve",
		"profile",
		"profiles",
		"queries",
		"recent",
		"region",
		"replayer",
		"reset",
		"restores",
		"reuse",
		"run",
		"security",
		"serializable",
		"sessionStates",
		"simple",
		"slave",
		"statsHealthy",
		"statsHistograms",
		"statsLocked",
		"statsMeta",
		"strict",
		"switchesSym",
		"system",
		"systemTime",
		"target",
		"telemetryID",
		"temptable",
		"textType",
		"tls",
		"top",
		"transaction",
		"triggers",
		"uncommitted",
		"undefined",
		"width",
		"x509",
		"addDate",
		"any",
		"approxCountDistinct",
		"approxPercentile",
		"avg",
		"bitAnd",
		"bitOr",
		"bitXor",
		"bound",
		"cast",
		"curTime",
		"dateAdd",
		"dateSub",
		"escape",
		"event",
		"exact",
		"exclusive",
		"extract",
		"file",
		"follower",
		"getFormat",
		"groupConcat",
		"jsonArrayagg",
		"jsonObjectAgg",
		"lastval",
		"leader",
		"learner",
		"max",
		"member",
		"min",
		"names",
		"now",
		"position",
		"process",
		"proxy",
		"quick",
		"replicas",
		"replication",
		"reverse",
		"rowCount",
		"setval",
		"shared",
		"some",
		"sqlBufferResult",
		"sqlCache",
		"sqlNoCache",
		"staleness",
		"std",
		"stddev",
		"stddevPop",
		"stddevSamp",
		"strong",
		"subDate",
		"substring",
		"sum",
		"super",
		"telemetry",
		"timestampAdd",
		"timestampDiff",
		"trim",
		"variance",
		"varPop",
		"varSamp",
		"voter",
		"weightString",
		"on",
		"'('",
		"stringLit",
		"with",
		"not2",
		"defaultKwd",
		"not",
		"as",
		"collate",
		"union",
		"using",
		"left",
		"right",
		"'+'",
		"'-'",
		"mod",
		"partition",
		"ignore",
		"except",
		"intersect",
		"null",
		"limit",
		"forKwd",
		"charType",
		"values",
		"into",
		"lock",
		"eq",
		"where",
		"from",
		"fetch",
		"order",
		"replace",
		"force",
		"intLit",
		"set",
		"and",
		"or",
		"andand",
		"pipesAsOr",
		"xor",
		"group",
		"having",
		"straightJoin",
		"window",
		"join",
		"like",
		"natural",
		"cross",
		"inner",
		"'*'",
		"'}'",
		"rows",
		"use",
		"tableSample",
		"rangeKwd",
		"groups",
		"desc",
		"binaryType",
		"dayHour",
		"dayMicrosecond",
		"dayMinute",
		"daySecond",
		"hourMicrosecond",
		"hourMinute",
		"hourSecond",
		"minuteMicrosecond",
		"minuteSecond",
		"secondMicrosecond",
		"yearMonth",
		"asc",
		"when",
		"elseKwd",
		"in",
		"then",
		"'/'",
		"'%'",
		"'&'",
		"'^'",
		"'|'",
		"div",
		"lsh",
		"rsh",
		"'<'",
		"'>'",
		"ge",
		"is",
		"le",
		"neq",
		"neqSynonym",
		"nulleq",
		"between",
		"ifKwd",
		"regexpKwd",
		"rlike",
		"memberof",
		"insert",
		"tableKwd",
		"singleAtIdentifier",
		"currentUser",
		"falseKwd",
		"trueKwd",
		"decLit",
		"floatLit",
		"row",
		"hexLit",
		"paramMarker",
		"bitLit",
		"interval",
		"'{'",
		"key",
		"database",
		"exists",
		"convert",
		"builtinNow",
		"currentTs",
		"doubleAtIdentifier",
		"localTime",
		"localTs",
		"underscoreCS",
		"builtinCount",
		"check",
		"pipes",
		"primary",
		"'!'",
		"'~'",
		"builtinApproxCountDistinct",
		"builtinApproxPercentile",
		"builtinBitAnd",
		"builtinBitOr",
		"builtinBitXor",
		"builtinCast",
		"builtinCurDate",
		"builtinCurTime",
		"builtinDateAdd",
		"builtinDateSub",
		"builtinExtract",
		"builtinGroupConcat",
		"builtinMax",
		"builtinMin",
		"builtinPosition",
		"builtinStddevPop",
		"builtinStddevSamp",
		"builtinSubstring",
		"builtinSum",
		"builtinSysDate",
		"builtinTranslate",
		"builtinTrim",
		"builtinUser",
		"builtinVarPop",
		"builtinVarSamp",
		"caseKwd",
		"cumeDist",
		"currentDate",
		"currentRole",
		"currentTime",
		"denseRank",
		"firstValue",
		"lag",
		"lastValue",
		"lead",
		"nthValue",
		"ntile",
		"percentRank",
		"rank",
		"repeat",
		"rowNumber",
		"tidbCurrentTSO",
		"utcDate",
		"utcTime",
		"utcTimestamp",
		"unique",
		"constraint",
		"references",
		"selectKwd",
		"generated",
		"character",
		"index",
		"match",
		"to",
		"all",
		"'.'",
		"analyze",
		"update",
		"maxValue",
		"jss",
		"juss",
		"array",
		"lines",
		"assignmentEq",
		"by",
		"alter",
		"require",
		"'@'",
		"Identifier",
		"NotKeywordToken",
		"TiDBKeyword",
		"UnReservedKeyword",
		"sql",
		"drop",
		"cascade",
		"read",
		"restrict",
		"asof",
		"create",
		"foreign",
		"fulltext",
		"toTimestamp",
		"varcharacter",
		"varcharType",
		"change",
		"decimalType",
		"doubleType",
		"floatType",
		"integerType",
		"intType",
		"realType",
		"rename",
		"write",
		"varbinaryType",
		"add",
		"bigIntType",
		"blobType",
		"int1Type",
		"int2Type",
		"int3Type",
		"int4Type",
		"int8Type",
		"long",
		"longblobType",
		"longtextType",
		"mediumblobType",
		"mediumIntType",
		"mediumtextType",
		"numericType",
		"optimize",
		"smallIntType",
		"tinyblobType",
		"tinyIntType",
		"tinytextType",
		"SubSelect",
		"UserVariable",
		"SimpleIdent",
		"Literal",
		"StringLiteral",
		"NextValueForSequence",
		"FunctionCallGeneric",
		"FunctionCallKeyword",
		"FunctionCallNonKeyword",
		"FunctionNameConflict",
		"FunctionNameDateArith",
		"FunctionNameDateArithMultiForms",
		"FunctionNameDatetimePrecision",
		"FunctionNameOptionalBraces",
		"FunctionNameSequence",
		"SimpleExpr",
		"SumExpr",
		"SystemVariable",
		"Variable",
		"WindowFuncCall",
		"BitExpr",
		"PredicateExpr",
		"BoolPri",
		"Expression",
		"NUM",
		"logAnd",
		"logOr",
		"EqOpt",
		"TableName",
		"StringName",
		"deleteKwd",
		"unsigned",
		"LengthNum",
		"over",
		"zerofill",
		"ColumnName",
		"distinct",
		"distinctRow",
		"WindowingClause",
		"SelectStmt",
		"SelectStmtBasic",
		"SelectStmtFromDualTable",
		"SelectStmtFromTable",
		"SetOprClause",
		"delayed",
		"highPriority",
		"lowPriority",
		"SetOprClauseList",
		"SetOprStmtWithLimitOrderBy",
		"SetOprStmtWoutLimitOrderBy",
		"WithClause",
		"SelectStmtWithClause",
		"SetOprStmt",
		"Int64Num",
		"hintComment",
		"FieldLen",
		"OptWindowingClause",
		"UpdateStmtNoWith",
		"DeleteWithoutUsingStmt",
		"OrderBy",
		"SelectStmtLimit",
		"sqlBigResult",
		"sqlCalcFoundRows",
		"sqlSmallResult",
		"InsertIntoStmt",
		"ReplaceIntoStmt",
		"UpdateStmt",
		"CharsetKw",
		"Username",
		"IfExists",
		"ExpressionList",
		"DeleteWithUsingStmt",
		"PlacementPolicyOption",
		"TableNameList",
		"IfNotExists",
		"terminated",
		"DeleteFromStmt",
		"DistinctKwd",
		"PartitionNameList",
		"DistinctOpt",
		"enclosed",
		"OptFieldLen",
		"TimestampUnit",
		"WhereClause",
		"WhereClauseOptional",
		"DefaultKwdOpt",
		"escaped",
		"optionally",
		"ExprOrDefault",
		"JoinTable",
		"OptBinary",
		"release",
		"RolenameComposed",
		"TableFactor",
		"TableRef",
		"AnalyzeOptionListOpt",
		"FromOrIn",
		"TimeUnit",
		"AlterTableStmt",
		"CharsetName",
		"ColumnNameList",
		"DBName",
		"load",
		"NotSym",
		"noWriteToBinLog",
		"OrderByOptional",
		"PartDefOption",
		"SignedNum",
		"BuggyDefaultFalseDistinctOpt",
		"DefaultFalseDistinctOpt",
		"JoinType",
		"NumLiteral",
		"Rolename",
		"RoleNameString",
		"CrossOpt",
		"EqOrAssignmentEq",
		"ExplainableStmt",
		"ExpressionListOpt",
		"IndexPartSpecification",
		"KeyOrIndex",
		"NoWriteToBinLogAliasOpt",
		"SelectStmtLimitOpt",
		"VariableName",
		"AllOrPartitionNameList",
		"ConstraintKeywordOpt",
		"DatabaseSym",
		"FieldsOrColumns",
		"ForceOpt",
		"IndexPartSpecificationList",
		"Priority",
		"RowFormat",
		"RowValue",
		"SetExpr",
		"ShowDatabaseNameOpt",
		"TableOption",
		"varying",
		"AnalyzeTableStmt",
		"BeginTransactionStmt",
		"BindableStmt",
		"column",
		"ColumnDef",
		"CommitStmt",
		"DatabaseOption",
		"EscapedTableRef",
		"FieldTerminator",
		"grant",
		"IgnoreOptional",
		"IndexInvisible",
		"IndexNameList",
		"IndexType",
		"LoadDataStmt",
		"PartitionNameListOpt",
		"PolicyName",
		"ReleaseSavepointStmt",
		"RolenameList",
		"RollbackStmt",
		"SavepointStmt",
		"SetStmt",
		"show",
		"TableOptimizerHints",
		"UsernameList",
		"WithClustered",
		"AlgorithmClause",
		"ByItem",
		"CollationName",
		"ColumnKeywordOpt",
		"DirectPlacementOption",
		"DirectResourceGroupOption",
		"FieldOpt",
		"FieldOpts",
		"IdentList",
		"IndexName",
		"IndexOption",
		"IndexOptionList",
		"infile",
		"LimitOption",
		"LockClause",
		"OptCharsetWithOptBinary",
		"OptNullTreatment",
		"PriorityOpt",
		"SelectLockOpt",
		"SelectStmtIntoOption",
		"TableRefs",
		"UserSpec",
		"Assignment",
		"AuthString",
		"BRIEBooleanOptionName",
		"BRIEIntegerOptionName",
		"BRIEKeywordOptionName",
		"BRIEOption",
		"BRIEOptions",
		"BRIEStringOptionName",
		"BuiltinFunction",
		"ByList",
		"Char",
		"ConfigItemName",
		"Constraint",
		"FloatOpt",
		"IndexTypeName",
		"option",
		"OptWild",
		"outer",
		"Precision",
		"ReferDef",
		"RestrictOrCascadeOpt",
		"RowStmt",
		"SequenceOption",
		"statsExtended",
		"TableAsName",
		"TableAsNameOpt",
		"TableNameOptWild",
		"TableOptimizerHintsOpt",
		"TableOptionList",
		"TraceableStmt",
		"TransactionChar",
		"UserSpecList",
		"WindowName",
		"AsOfClause",
		"AssignmentList",
		"AttributesOpt",
		"Boolean",
		"ColumnOption",
		"ColumnPosition",
		"CommonTableExpr",
		"CreateTableStmt",
		"DatabaseOptionList",
		"DefaultTrueDistinctOpt",
		"EnforcedOrNot",
		"explain",
		"ExtendedPriv",
		"GeneratedAlways",
		"GlobalScope",
		"GroupByClause",
		"IndexHint",
		"IndexHintType",
		"IndexNameAndTypeOpt",
		"keys",
		"Lines",
		"MaxValueOrExpression",
		"NowSym",
		"NowSymFunc",
		"NowSymOptionFraction",
		"OptOrder",
		"OptTemporary",
		"PartDefOptionList",
		"PartitionDefinition",
		"PasswordOrLockOption",
		"PluginNameList",
		"PrimaryOpt",
		"PrivElem",
		"PrivType",
		"procedure",
		"RequireClause",
		"RequireClauseOpt",
		"RequireListElement",
		"RolenameWithoutIdent",
		"RoleOrPrivElem",
		"SelectStmtGroup",
		"SetOprOpt",
		"TableAliasRefList",
		"TableElement",
		"TableNameListOpt2",
		"TextString",
		"TransactionChars",
		"trigger",
		"unlock",
		"usage",
		"ValuesList",
		"ValuesStmtList",
		"ValueSym",
		"VariableAssignment",
		"WindowFrameStart",
		"AdminStmt",
		"AllColumnsOrPredicateColumnsOpt",
		"AlterDatabaseStmt",
		"AlterImportStmt",
		"AlterInstanceStmt",
		"AlterOrderItem",
		"AlterPolicyStmt",
		"AlterResourceGroupStmt",
		"AlterSequenceOption",
		"AlterSequenceStmt",
		"AlterTableSpec",
		"AlterUserStmt",
		"AnalyzeOption",
		"BinlogStmt",
		"BRIEStmt",
		"BRIETables",
		"call",
		"CallStmt",
		"CastType",
		"ChangeStmt",
		"CheckConstraintKeyword",
		"ColumnNameListOpt",
		"ColumnNameOrUserVariable",
		"ColumnOptionList",
		"ColumnOptionListOpt",
		"ColumnSetValue",
		"CommentOrAttributeOption",
		"CompletionTypeWithinTransaction",
		"ConnectionOption",
		"ConnectionOptions",
		"CreateBindingStmt",
		"CreateDatabaseStmt",
		"CreateImportStmt",
		"CreateIndexStmt",
		"CreatePolicyStmt",
		"CreateResourceGroupStmt",
		"CreateRoleStmt",
		"CreateSequenceStmt",
		"CreateStatisticsStmt",
		"CreateTableOptionListOpt",
		"CreateUserStmt",
		"CreateViewStmt",
		"databases",
		"DeallocateStmt",
		"DeallocateSym",
		"describe",
		"DoStmt",
		"DropBindingStmt",
		"DropDatabaseStmt",
		"DropImportStmt",
		"DropIndexStmt",
		"DropPolicyStmt",
		"DropRoleStmt",
		"DropSequenceStmt",
		"DropStatisticsStmt",
		"DropStatsStmt",
		"DropTableStmt",
		"DropUserStmt",
		"DropViewStmt",
		"DuplicateOpt",
		"EmptyStmt",
		"EncryptionOpt",
		"EnforcedOrNotOpt",
		"ErrorHandling",
		"ExecuteStmt",
		"ExplainFormatType",
		"ExplainStmt",
		"ExplainSym",
		"Field",
		"FieldItem",
		"Fields",
		"FlashbackDatabaseStmt",
		"FlashbackTableStmt",
		"FlashbackToNewName",
		"FlashbackToTimestampStmt",
		"FlushStmt",
		"FuncDatetimePrecList",
		"FuncDatetimePrecListOpt",
		"GrantProxyStmt",
		"GrantRoleStmt",
		"GrantStmt",
		"HandleRange",
		"HashString",
		"HavingClause",
		"HelpStmt",
		"IndexAdviseStmt",
		"IndexHintList",
		"IndexHintListOpt",
		"IndexLockAndAlgorithmOpt",
		"InsertValues",
		"IntoOpt",
		"KeyOrIndexOpt",
		"kill",
		"KillOrKillTiDB",
		"KillStmt",
		"LimitClause",
		"linear",
		"LinearOpt",
		"LoadDataSetItem",
		"LoadStatsStmt",
		"LocalOpt",
		"LocationLabelList",
		"LockStatsStmt",
		"LockTablesStmt",
		"MaxValueOrExpressionList",
		"NonTransactionalDMLStmt",
		"NowSymOptionFractionParentheses",
		"NumList",
		"ObjectType",
		"of",
		"OfTablesOpt",
		"OnCommitOpt",
		"OnDelete",
		"OnUpdate",
		"OptCollate",
		"OptFull",
		"OptInteger",
		"OptionalBraces",
		"OptionLevel",
		"OptLeadLagInfo",
		"OptLLDefault",
		"OuterOpt",
		"PartitionDefinitionList",
		"PartitionDefinitionListOpt",
		"PartitionIntervalOpt",
		"PartitionOpt",
		"PasswordOpt",
		"PasswordOrLockOptionList",
		"PasswordOrLockOptions",
		"PlacementOptionList",
		"PlanReplayerStmt",
		"PreparedStmt",
		"PrivLevel",
		"PurgeImportStmt",
		"QuickOptional",
		"RecoverTableStmt",
		"ReferOpt",
		"RegexpSym",
		"RenameTableStmt",
		"RenameUserStmt",
		"RepeatableOpt",
		"ResourceGroupName",
		"ResourceGroupNameOption",
		"ResourceGroupOptionList",
		"RestartStmt",
		"ResumeImportStmt",
		"revoke",
		"RevokeRoleStmt",
		"RevokeStmt",
		"RoleOrPrivElemList",
		"RoleSpec",
		"SelectStmtOpt",
		"SelectStmtSQLCache",
		"SetBindingStmt",
		"SetDefaultRoleOpt",
		"SetDefaultRoleStmt",
		"SetRoleStmt",
		"ShowImportStmt",
		"ShowProfileType",
		"ShowStmt",
		"ShowTableAliasOpt",
		"ShutdownStmt",
		"SignedLiteral",
		"SplitOption",
		"SplitRegionStmt",
		"Statement",
		"StatsOptionsOpt",
		"StatsPersistentVal",
		"StatsType",
		"StopImportStmt",
		"SubPartDefinition",
		"SubPartitionMethod",
		"Symbol",
		"TableElementList",
		"TableLock",
		"TableNameListOpt",
		"TableOrTables",
		"TablesTerminalSym",
		"TableToTable",
		"TextStringList",
		"TraceStmt",
		"TruncateTableStmt",
		"UnlockStatsStmt",
		"UnlockTablesStmt",
		"UserToUser",
		"UseStmt",
		"Varchar",
		"VariableAssignmentList",
		"WhenClause",
		"WindowDefinition",
		"WindowFrameBound",
		"WindowSpec",
		"WithGrantOptionOpt",
		"WithList",
		"Writeable",
		"AdminShowSlow",
		"AdminStmtLimitOpt",
		"AlterOrderList",
		"AlterSequenceOptionList",
		"AlterTableSpecList",
		"AlterTableSpecListOpt",
		"AlterTableSpecSingleOpt",
		"AnalyzeOptionList",
		"AnyOrAll",
		"ArrayKwdOpt",
		"AsOfClauseOpt",
		"AsOpt",
		"AuthOption",
		"AuthPlugin",
		"AutoRandomOpt",
		"BetweenOrNotOp",
		"BindingStatusType",
		"BitValueType",
		"BlobType",
		"BooleanType",
		"both",
		"CharsetNameOrDefault",
		"CharsetOpt",
		"ColumnFormat",
		"ColumnList",
		"ColumnNameOrUserVariableList",
		"ColumnNameOrUserVarListOpt",
		"ColumnNameOrUserVarListOptWithBrackets",
		"ColumnSetValueList",
		"CompareOp",
		"ConnectionOptionList",
		"ConstraintElem",
		"CreateSequenceOptionListOpt",
		"CreateTableSelectOpt",
		"CreateViewSelectOpt",
		"DatabaseOptionListOpt",
		"DateAndTimeType",
		"DBNameList",
		"DefaultValueExpr",
		"DryRunOptions",
		"dual",
		"ElseOpt",
		"EnforcedOrNotOrNotNullOpt",
		"ExpressionOpt",
		"FetchFirstOpt",
		"FieldAsName",
		"FieldAsNameOpt",
		"FieldItemList",
		"FieldList",
		"FirstAndLastPartOpt",
		"FirstOrNext",
		"FixedPointType",
		"FloatingPointType",
		"FlushOption",
		"FromDual",
		"FulltextSearchModifierOpt",
		"FuncDatetimePrec",
		"GetFormatSelector",
		"HandleRangeList",
		"IdentListWithParenOpt",
		"IfNotRunning",
		"IfRunning",
		"IgnoreLines",
		"ImportTruncate",
		"IndexHintScope",
		"IndexKeyTypeOpt",
		"IndexPartSpecificationListOpt",
		"IndexTypeOpt",
		"InOrNotOp",
		"InstanceOption",
		"IntegerType",
		"IntervalExpr",
		"IsolationLevel",
		"IsOrNotOp",
		"leading",
		"LikeEscapeOpt",
		"LikeOrNotOp",
		"LikeTableWithOrWithoutParen",
		"LinesTerminated",
		"LoadDataSetList",
		"LoadDataSetSpecOpt",
		"LockType",
		"LogTypeOpt",
		"Match",
		"MatchOpt",
		"MaxIndexNumOpt",
		"MaxMinutesOpt",
		"MaxValPartOpt",
		"NChar",
		"NullPartOpt",
		"NumericType",
		"NVarchar",
		"OnDeleteUpdateOpt",
		"OnDuplicateKeyUpdate",
		"OptBinMod",
		"OptCharset",
		"OptErrors",
		"OptExistingWindowName",
		"OptFromFirstLast",
		"OptGConcatSeparator",
		"OptionalShardColumn",
		"OptPartitionClause",
		"OptTable",
		"OptWindowFrameClause",
		"OptWindowOrderByClause",
		"Order",
		"OrReplace",
		"outfile",
		"PartDefValuesOpt",
		"PartitionKeyAlgorithmOpt",
		"PartitionMethod",
		"PartitionNumOpt",
		"PerDB",
		"PerTable",
		"precisionType",
		"PrepareSQL",
		"ProcedureCall",
		"recursive",
		"RegexpOrNotOp",
		"ReorganizePartitionRuleOpt",
		"RequireList",
		"RoleSpecList",
		"RowOrRows",
		"SelectStmtFieldList",
		"SelectStmtOpts",
		"SelectStmtOptsList",
		"SequenceOptionList",
		"SetOpr",
		"SetRoleOpt",
		"ShardableStmt",
		"ShowIndexKwd",
		"ShowLikeOrWhereOpt",
		"ShowPlacementTarget",
		"ShowProfileArgsOpt",
		"ShowProfileTypes",
		"ShowProfileTypesOpt",
		"ShowTargetFilterable",
		"spatial",
		"SplitSyntaxOption",
		"ssl",
		"Start",
		"Starting",
		"starting",
		"StatementList",
		"StatementScope",
		"StorageMedia",
		"stored",
		"StringList",
		"StringNameOrBRIEOptionKeyword",
		"StringType",
		"SubPartDefinitionList",
		"SubPartDefinitionListOpt",
		"SubPartitionNumOpt",
		"SubPartitionOpt",
		"TableElementListOpt",
		"TableLockList",
		"TableRefsClause",
		"TableSampleMethodOpt",
		"TableSampleOpt",
		"TableSampleUnitOpt",
		"TableToTableList",
		"TextType",
		"trailing",
		"TrimDirection",
		"Type",
		"UserToUserList",
		"UserVariableList",
		"UsingRoles",
		"Values",
		"ValuesOpt",
		"ViewAlgorithm",
		"ViewCheckOption",
		"ViewDefiner",
		"ViewFieldList",
		"ViewName",
		"ViewSQLSecurity",
		"virtual",
		"VirtualOrStored",
		"WhenClauseList",
		"WindowClauseOptional",
		"WindowDefinitionList",
		"WindowFrameBetween",
		"WindowFrameExtent",
		"WindowFrameUnits",
		"WindowNameOrSpec",
		"WindowSpecDetails",
		"WithReadLockOpt",
		"WithValidation",
		"WithValidationOpt",
		"Year",
		"$default",
		"andnot",
		"AssignmentListOpt",
		"ColumnDefList",
		"CommaOpt",
		"createTableSelect",
		"empty",
		"error",
		"higherThanComma",
		"higherThanParenthese",
		"insertValues",
		"invalid",
		"lowerThanCharsetKwd",
		"lowerThanComma",
		"lowerThanCreateTableSelect",
		"lowerThanEq",
		"lowerThanFunction",
		"lowerThanInsertValues",
		"lowerThanKey",
		"lowerThanLocal",
		"lowerThanNot",
		"lowerThanOn",
		"lowerThanParenthese",
		"lowerThanRemove",
		"lowerThanSelectOpt",
		"lowerThanSelectStmt",
		"lowerThanSetKeyword",
		"lowerThanStringLitToken",
		"lowerThanValueKeyword",
		"lowerThenOrder",
		"neg",
		"odbcDateType",
		"odbcTimestampType",
		"odbcTimeType",
		"tableRefPriority",
	}

	xx := make(map[string]struct{}, len(yySymNames))
	for _, name := range yySymNames {
		if _, ok := xx[name]; ok {
			t.Fatal(1)
		}
		xx[name] = struct{}{}
	}

	yySymNames = []string{
		"$end",
		"';'",
		"remove",
		"reorganize",
		"comment",
		"storage",
		"autoIncrement",
		"','",
		"first",
		"after",
		"serial",
		"autoRandom",
		"columnFormat",
		"password",
		"charsetKwd",
		"checksum",
		"placement",
		"keyBlockSize",
		"tablespace",
		"encryption",
		"engine",
		"data",
		"insertMethod",
		"maxRows",
		"minRows",
		"nodegroup",
		"connection",
		"autoRandomBase",
		"statsBuckets",
		"statsTopN",
		"autoIdCache",
		"avgRowLength",
		"compression",
		"delayKeyWrite",
		"packKeys",
		"preSplitRegions",
		"rowFormat",
		"secondaryEngine",
		"shardRowIDBits",
		"statsAutoRecalc",
		"statsColChoice",
		"statsColList",
		"statsPersistent",
		"statsSamplePages",
		"statsSampleRate",
		"tableChecksum",
		"account",
		"resume",
		"signed",
		"snapshot",
		"backend",
		"checkpoint",
		"concurrency",
		"csvBackslashEscape",
		"csvDelimiter",
		"csvHeader",
		"csvNotNull",
		"csvNull",
		"csvSeparator",
		"csvTrimLastSeparators",
		"lastBackup",
		"onDuplicate",
		"online",
		"rateLimit",
		"sendCredentialsToTiKV",
		"skipSchemaFiles",
		"strictFormat",
		"tikvImporter",
		"truncate",
		"no",
		"start",
		"cache",
		"nocache",
		"')'",
		"cycle",
		"minValue",
		"increment",
		"nocycle",
		"nomaxvalue",
		"nominvalue",
		"restart",
		"algorithm",
		"regions",
		"tp",
		"clustered",
		"invisible",
		"nonclustered",
		"visible",
		"constraints",
		"followerConstraints",
		"followers",
		"leaderConstraints",
		"learnerConstraints",
		"learners",
		"primaryRegion",
		"schedule",
		"voterConstraints",
		"voters",
		"columns",
		"view",
		"subpartition",
		"ascii",
		"byteType",
		"partitions",
		"unicodeSym",
		"yearType",
		"day",
		"fields",
		"second",
		"sqlTsiYear",
		"tables",
		"hour",
		"microsecond",
		"minute",
		"month",
		"quarter",
		"sqlTsiDay",
		"sqlTsiHour",
		"sqlTsiMinute",
		"sqlTsiMonth",
		"sqlTsiQuarter",
		"sqlTsiSecond",
		"sqlTsiWeek",
		"status",
		"week",
		"separator",
		"maxConnectionsPerHour",
		"maxQueriesPerHour",
		"maxUpdatesPerHour",
		"maxUserConnections",
		"preceding",
		"cipher",
		"importKwd",
		"issuer",
		"local",
		"san",
		"subject",
		"skip",
		"bindings",
		"definer",
		"hash",
		"identified",
		"logs",
		"query",
		"respect",
		"commit",
		"current",
		"enforced",
		"following",
		"next_row_id",
		"nowait",
		"only",
		"rollback",
		"value",
		"begin",
		"binding",
		"end",
		"global",
		"policy",
		"predicate",
		"temporary",
		"unbounded",
		"user",
		"identifier",
		"offset",
		"planCache",
		"prepare",
		"role",
		"unknown",
		"wait",
		"btree",
		"datetimeType",
		"dateType",
		"disable",
		"enable",
		"fixed",
		"isolation",
		"jsonType",
		"location",
		"max_idxnum",
		"memory",
		"off",
		"optional",
		"per_db",
		"privileges",
		"required",
		"rtree",
		"running",
		"sampleRate",
		"sequence",
		"session",
		"slow",
		"timeType",
		"validation",
		"variables",
		"attributes",
		"duplicate",
		"dynamic",
		"errorKwd",
		"flush",
		"full",
		"identSQLErrors",
		"mb",
		"mode",
		"never",
		"plan",
		"plugins",
		"processlist",
		"quick",
		"recover",
		"repair",
		"repeatable",
		"replica",
		"statistics",
		"subpartitions",
		"tidb",
		"timestampType",
		"without",
		"admin",
		"backup",
		"binlog",
		"block",
		"booleanType",
		"buckets",
		"cardinality",
		"chain",
		"clientErrorsSummary",
		"cmSketch",
		"coalesce",
		"compact",
		"compressed",
		"context",
		"copyKwd",
		"correlation",
		"cpu",
		"deallocate",
		"dependency",
		"directory",
		"discard",
		"disk",
		"do",
		"drainer",
		"exchange",
		"execute",
		"expansion",
		"flashback",
		"general",
		"help",
		"histogram",
		"hosts",
		"inplace",
		"instance",
		"instant",
		"ipc",
		"job",
		"jobs",
		"labels",
		"locked",
		"modify",
		"next",
		"nodeID",
		"nodeState",
		"nulls",
		"pageSym",
		"pump",
		"purge",
		"rebuild",
		"redundant",
		"reload",
		"restore",
		"routine",
		"s3",
		"samples",
		"secondaryLoad",
		"secondaryUnload",
		"share",
		"shutdown",
		"source",
		"split",
		"stats",
		"statsOptions",
		"stop",
		"swaps",
		"tiFlash",
		"tokudbDefault",
		"tokudbFast",
		"tokudbLzma",
		"tokudbQuickLZ",
		"tokudbSmall",
		"tokudbSnappy",
		"tokudbUncompressed",
		"tokudbZlib",
		"topn",
		"trace",
		"action",
		"advise",
		"against",
		"ago",
		"always",
		"backups",
		"bernoulli",
		"bitType",
		"boolType",
		"briefType",
		"builtins",
		"cancel",
		"capture",
		"cascaded",
		"causal",
		"cleanup",
		"client",
		"collation",
		"columnStatsUsage",
		"committed",
		"config",
		"consistency",
		"consistent",
		"ddl",
		"depth",
		"dotType",
		"dump",
		"engines",
		"enum",
		"events",
		"evolve",
		"expire",
		"exprPushdownBlacklist",
		"extended",
		"faultsSym",
		"format",
		"function",
		"grants",
		"histogramsInFlight",
		"history",
		"imports",
		"incremental",
		"indexes",
		"internal",
		"invoker",
		"io",
		"language",
		"last",
		"less",
		"level",
		"list",
		"master",
		"max_minutes",
		"merge",
		"national",
		"ncharType",
		"nextval",
		"nodes",
		"none",
		"nvarcharType",
		"open",
		"optimistic",
		"optRuleBlacklist",
		"parser",
		"partial",
		"partitioning",
		"per_table",
		"percent",
		"pessimistic",
		"preserve",
		"profile",
		"profiles",
		"queries",
		"recent",
		"region",
		"replayer",
		"replicas",
		"reset",
		"restores",
		"rules",
		"security",
		"serializable",
		"sharding",
		"simple",
		"slave",
		"statsHealthy",
		"statsHistograms",
		"statsMeta",
		"strict",
		"switchesSym",
		"system",
		"systemTime",
		"target",
		"telemetryID",
		"temptable",
		"textType",
		"than",
		"tls",
		"top",
		"topology",
		"traditional",
		"transaction",
		"triggers",
		"uncommitted",
		"undefined",
		"users",
		"verboseType",
		"warnings",
		"width",
		"x509",
		"addDate",
		"any",
		"approxCountDistinct",
		"approxPercentile",
		"avg",
		"bitAnd",
		"bitOr",
		"bitXor",
		"bound",
		"cast",
		"curTime",
		"dateAdd",
		"dateSub",
		"escape",
		"event",
		"exact",
		"exclusive",
		"extract",
		"file",
		"follower",
		"getFormat",
		"groupConcat",
		"jsonArrayagg",
		"jsonObjectAgg",
		"lastval",
		"leader",
		"learner",
		"max",
		"min",
		"names",
		"now",
		"position",
		"process",
		"proxy",
		"replication",
		"reverse",
		"rowCount",
		"setval",
		"shared",
		"some",
		"sqlBufferResult",
		"sqlCache",
		"sqlNoCache",
		"staleness",
		"std",
		"stddev",
		"stddevPop",
		"stddevSamp",
		"strong",
		"subDate",
		"substring",
		"sum",
		"super",
		"tableRules",
		"telemetry",
		"timestampAdd",
		"timestampDiff",
		"trim",
		"variance",
		"varPop",
		"varSamp",
		"voter",
		"weightString",
		"on",
		"'('",
		"with",
		"stringLit",
		"not2",
		"not",
		"as",
		"defaultKwd",
		"union",
		"using",
		"left",
		"right",
		"collate",
		"'-'",
		"'+'",
		"mod",
		"limit",
		"fetch",
		"except",
		"intersect",
		"ignore",
		"partition",
		"null",
		"forKwd",
		"into",
		"lock",
		"from",
		"eq",
		"where",
		"order",
		"values",
		"force",
		"set",
		"and",
		"charType",
		"replace",
		"intLit",
		"or",
		"andand",
		"pipesAsOr",
		"xor",
		"group",
		"straightJoin",
		"window",
		"having",
		"join",
		"natural",
		"cross",
		"inner",
		"like",
		"'}'",
		"'*'",
		"rows",
		"use",
		"tableSample",
		"rangeKwd",
		"groups",
		"desc",
		"asc",
		"dayHour",
		"dayMicrosecond",
		"dayMinute",
		"daySecond",
		"hourMicrosecond",
		"hourMinute",
		"hourSecond",
		"minuteMicrosecond",
		"minuteSecond",
		"secondMicrosecond",
		"yearMonth",
		"when",
		"in",
		"elseKwd",
		"binaryType",
		"then",
		"'<'",
		"'>'",
		"ge",
		"is",
		"le",
		"neq",
		"neqSynonym",
		"nulleq",
		"between",
		"'/'",
		"'%'",
		"'&'",
		"'^'",
		"'|'",
		"div",
		"lsh",
		"rsh",
		"regexpKwd",
		"rlike",
		"ifKwd",
		"insert",
		"tableKwd",
		"singleAtIdentifier",
		"currentUser",
		"falseKwd",
		"trueKwd",
		"decLit",
		"floatLit",
		"row",
		"hexLit",
		"key",
		"paramMarker",
		"'{'",
		"bitLit",
		"interval",
		"pipes",
		"database",
		"exists",
		"check",
		"convert",
		"primary",
		"doubleAtIdentifier",
		"builtinNow",
		"currentTs",
		"localTime",
		"localTs",
		"underscoreCS",
		"'!'",
		"'~'",
		"builtinApproxCountDistinct",
		"builtinApproxPercentile",
		"builtinBitAnd",
		"builtinBitOr",
		"builtinBitXor",
		"builtinCast",
		"builtinCount",
		"builtinCurDate",
		"builtinCurTime",
		"builtinDateAdd",
		"builtinDateSub",
		"builtinExtract",
		"builtinGroupConcat",
		"builtinMax",
		"builtinMin",
		"builtinPosition",
		"builtinStddevPop",
		"builtinStddevSamp",
		"builtinSubstring",
		"builtinSum",
		"builtinSysDate",
		"builtinTranslate",
		"builtinTrim",
		"builtinUser",
		"builtinVarPop",
		"builtinVarSamp",
		"caseKwd",
		"cumeDist",
		"currentDate",
		"currentRole",
		"currentTime",
		"denseRank",
		"firstValue",
		"lag",
		"lastValue",
		"lead",
		"nthValue",
		"ntile",
		"percentRank",
		"rank",
		"repeat",
		"rowNumber",
		"utcDate",
		"utcTime",
		"utcTimestamp",
		"unique",
		"constraint",
		"references",
		"generated",
		"selectKwd",
		"character",
		"match",
		"index",
		"to",
		"all",
		"'.'",
		"analyze",
		"update",
		"jss",
		"juss",
		"maxValue",
		"lines",
		"by",
		"assignmentEq",
		"Identifier",
		"NotKeywordToken",
		"TiDBKeyword",
		"UnReservedKeyword",
		"require",
		"alter",
		"'@'",
		"sql",
		"drop",
		"cascade",
		"read",
		"restrict",
		"asof",
		"create",
		"foreign",
		"fulltext",
		"varcharacter",
		"varcharType",
		"change",
		"decimalType",
		"doubleType",
		"floatType",
		"integerType",
		"intType",
		"optimize",
		"realType",
		"rename",
		"write",
		"varbinaryType",
		"add",
		"bigIntType",
		"blobType",
		"int1Type",
		"int2Type",
		"int3Type",
		"int4Type",
		"int8Type",
		"long",
		"longblobType",
		"longtextType",
		"mediumblobType",
		"mediumIntType",
		"mediumtextType",
		"numericType",
		"smallIntType",
		"tinyblobType",
		"tinyIntType",
		"tinytextType",
		"SubSelect",
		"UserVariable",
		"SimpleIdent",
		"Literal",
		"StringLiteral",
		"NextValueForSequence",
		"FunctionCallGeneric",
		"FunctionCallKeyword",
		"FunctionCallNonKeyword",
		"FunctionNameConflict",
		"FunctionNameDateArith",
		"FunctionNameDateArithMultiForms",
		"FunctionNameDatetimePrecision",
		"FunctionNameOptionalBraces",
		"FunctionNameSequence",
		"SimpleExpr",
		"SumExpr",
		"SystemVariable",
		"Variable",
		"WindowFuncCall",
		"BitExpr",
		"PredicateExpr",
		"BoolPri",
		"Expression",
		"NUM",
		"logAnd",
		"logOr",
		"TableName",
		"EqOpt",
		"StringName",
		"unsigned",
		"over",
		"zerofill",
		"deleteKwd",
		"LengthNum",
		"ColumnName",
		"distinct",
		"distinctRow",
		"WindowingClause",
		"delayed",
		"highPriority",
		"lowPriority",
		"SelectStmt",
		"SelectStmtBasic",
		"SelectStmtFromDualTable",
		"SelectStmtFromTable",
		"SetOprClause",
		"SetOprClauseList",
		"SetOprStmtWithLimitOrderBy",
		"SetOprStmtWoutLimitOrderBy",
		"SelectStmtWithClause",
		"SetOprStmt",
		"WithClause",
		"hintComment",
		"FieldLen",
		"Int64Num",
		"OptWindowingClause",
		"SelectStmtLimit",
		"OrderBy",
		"sqlBigResult",
		"sqlCalcFoundRows",
		"sqlSmallResult",
		"CharsetKw",
		"UpdateStmtNoWith",
		"Username",
		"DeleteWithoutUsingStmt",
		"InsertIntoStmt",
		"ReplaceIntoStmt",
		"UpdateStmt",
		"ExpressionList",
		"IfExists",
		"PlacementPolicyOption",
		"terminated",
		"DistinctKwd",
		"IfNotExists",
		"OptFieldLen",
		"TableNameList",
		"DistinctOpt",
		"enclosed",
		"PartitionNameList",
		"WhereClause",
		"WhereClauseOptional",
		"DefaultKwdOpt",
		"DeleteWithUsingStmt",
		"escaped",
		"optionally",
		"DeleteFromStmt",
		"ExprOrDefault",
		"JoinTable",
		"OptBinary",
		"RolenameComposed",
		"TableFactor",
		"TableRef",
		"AnalyzeOptionListOpt",
		"DBName",
		"FromOrIn",
		"TimestampUnit",
		"CharsetName",
		"ColumnNameList",
		"load",
		"NotSym",
		"noWriteToBinLog",
		"OrderByOptional",
		"PartDefOption",
		"SignedNum",
		"BuggyDefaultFalseDistinctOpt",
		"DefaultFalseDistinctOpt",
		"JoinType",
		"NumLiteral",
		"Rolename",
		"RoleNameString",
		"SelectStmtLimitOpt",
		"AlterTableStmt",
		"CrossOpt",
		"EqOrAssignmentEq",
		"ExpressionListOpt",
		"IndexPartSpecification",
		"KeyOrIndex",
		"NoWriteToBinLogAliasOpt",
		"TimeUnit",
		"VariableName",
		"AllOrPartitionNameList",
		"ConstraintKeywordOpt",
		"FieldsOrColumns",
		"ForceOpt",
		"IndexPartSpecificationList",
		"Priority",
		"RowFormat",
		"RowValue",
		"SetExpr",
		"ShowDatabaseNameOpt",
		"TableOption",
		"varying",
		"BeginTransactionStmt",
		"BindableStmt",
		"column",
		"ColumnDef",
		"CommitStmt",
		"DatabaseOption",
		"DatabaseSym",
		"EscapedTableRef",
		"ExplainableStmt",
		"FieldTerminator",
		"grant",
		"IgnoreOptional",
		"IndexInvisible",
		"IndexNameList",
		"IndexType",
		"LoadDataStmt",
		"PartitionNameListOpt",
		"release",
		"RolenameList",
		"RollbackStmt",
		"SetStmt",
		"show",
		"TableOptimizerHints",
		"UsernameList",
		"WithClustered",
		"AlgorithmClause",
		"ByItem",
		"CollationName",
		"ColumnKeywordOpt",
		"DirectPlacementOption",
		"FieldOpt",
		"FieldOpts",
		"IdentList",
		"IndexName",
		"IndexOption",
		"IndexOptionList",
		"infile",
		"LimitOption",
		"LockClause",
		"OptCharsetWithOptBinary",
		"OptNullTreatment",
		"PolicyName",
		"PriorityOpt",
		"SelectLockOpt",
		"SelectStmtIntoOption",
		"TableRefs",
		"UserSpec",
		"Assignment",
		"AuthString",
		"BRIEBooleanOptionName",
		"BRIEIntegerOptionName",
		"BRIEKeywordOptionName",
		"BRIEOption",
		"BRIEOptions",
		"BRIEStringOptionName",
		"ByList",
		"Char",
		"ConfigItemName",
		"Constraint",
		"FloatOpt",
		"IndexTypeName",
		"option",
		"OptWild",
		"outer",
		"Precision",
		"ReferDef",
		"RestrictOrCascadeOpt",
		"RowStmt",
		"SequenceOption",
		"statsExtended",
		"TableAsName",
		"TableAsNameOpt",
		"TableNameOptWild",
		"TableOptimizerHintsOpt",
		"TableOptionList",
		"TraceableStmt",
		"TransactionChar",
		"trigger",
		"UserSpecList",
		"WindowName",
		"AsOfClause",
		"AssignmentList",
		"AttributesOpt",
		"Boolean",
		"ColumnOption",
		"ColumnPosition",
		"CommonTableExpr",
		"CreateTableStmt",
		"DatabaseOptionList",
		"DefaultTrueDistinctOpt",
		"EnforcedOrNot",
		"explain",
		"ExtendedPriv",
		"GeneratedAlways",
		"GlobalScope",
		"GroupByClause",
		"IndexHint",
		"IndexHintType",
		"IndexNameAndTypeOpt",
		"keys",
		"Lines",
		"MaxValueOrExpression",
		"OptOrder",
		"OptTemporary",
		"PartDefOptionList",
		"PartitionDefinition",
		"PasswordExpire",
		"PasswordOrLockOption",
		"PluginNameList",
		"PrimaryOpt",
		"PrivElem",
		"PrivType",
		"procedure",
		"QuickOptional",
		"RequireClause",
		"RequireClauseOpt",
		"RequireListElement",
		"RolenameWithoutIdent",
		"RoleOrPrivElem",
		"SelectStmtGroup",
		"SetOprOpt",
		"TableAliasRefList",
		"TableElement",
		"TableNameListOpt2",
		"TextString",
		"TransactionChars",
		"unlock",
		"usage",
		"ValuesList",
		"ValuesStmtList",
		"ValueSym",
		"VariableAssignment",
		"WindowFrameStart",
		"AdminStmt",
		"AllColumnsOrPredicateColumnsOpt",
		"AlterDatabaseStmt",
		"AlterImportStmt",
		"AlterInstanceStmt",
		"AlterOrderItem",
		"AlterPolicyStmt",
		"AlterSequenceOption",
		"AlterSequenceStmt",
		"AlterTableSpec",
		"AlterUserStmt",
		"AnalyzeOption",
		"AnalyzeTableStmt",
		"BinlogStmt",
		"BRIEStmt",
		"BRIETables",
		"call",
		"CallStmt",
		"CastType",
		"ChangeStmt",
		"CheckConstraintKeyword",
		"ColumnNameListOpt",
		"ColumnNameOrUserVariable",
		"ColumnOptionList",
		"ColumnOptionListOpt",
		"ColumnSetValue",
		"CompletionTypeWithinTransaction",
		"ConnectionOption",
		"ConnectionOptions",
		"CreateBindingStmt",
		"CreateDatabaseStmt",
		"CreateImportStmt",
		"CreateIndexStmt",
		"CreatePolicyStmt",
		"CreateRoleStmt",
		"CreateSequenceStmt",
		"CreateStatisticsStmt",
		"CreateTableOptionListOpt",
		"CreateUserStmt",
		"CreateViewStmt",
		"databases",
		"DeallocateStmt",
		"DeallocateSym",
		"describe",
		"DoStmt",
		"DropBindingStmt",
		"DropDatabaseStmt",
		"DropImportStmt",
		"DropIndexStmt",
		"DropPolicyStmt",
		"DropRoleStmt",
		"DropSequenceStmt",
		"DropStatisticsStmt",
		"DropStatsStmt",
		"DropTableStmt",
		"DropTriggerStmt",
		"DropUserStmt",
		"DropViewStmt",
		"DuplicateOpt",
		"EmptyStmt",
		"EncryptionOpt",
		"EnforcedOrNotOpt",
		"ErrorHandling",
		"ExecuteStmt",
		"ExplainStmt",
		"ExplainSym",
		"Field",
		"FieldItem",
		"Fields",
		"FlashbackTableStmt",
		"FlushStmt",
		"FuncDatetimePrecList",
		"FuncDatetimePrecListOpt",
		"GrantProxyStmt",
		"GrantRoleStmt",
		"GrantStmt",
		"HandleRange",
		"HashString",
		"HelpStmt",
		"IndexAdviseStmt",
		"IndexHintList",
		"IndexHintListOpt",
		"IndexLockAndAlgorithmOpt",
		"InsertValues",
		"IntoOpt",
		"KeyOrIndexOpt",
		"kill",
		"KillOrKillTiDB",
		"KillStmt",
		"LimitClause",
		"linear",
		"LinearOpt",
		"LoadDataSetItem",
		"LoadStatsStmt",
		"LocalOpt",
		"LocationLabelList",
		"LockTablesStmt",
		"MaxValueOrExpressionList",
		"NowSym",
		"NowSymFunc",
		"NowSymOptionFraction",
		"NumList",
		"ObjectType",
		"of",
		"OfTablesOpt",
		"OnCommitOpt",
		"OnDelete",
		"OnUpdate",
		"OptCollate",
		"OptFull",
		"OptInteger",
		"OptionalBraces",
		"OptionLevel",
		"OptLeadLagInfo",
		"OptLLDefault",
		"OuterOpt",
		"PartitionDefinitionList",
		"PartitionDefinitionListOpt",
		"PartitionOpt",
		"PasswordOpt",
		"PasswordOrLockOptionList",
		"PasswordOrLockOptions",
		"PlacementOptionList",
		"PlanReplayerStmt",
		"PreparedStmt",
		"PrivLevel",
		"PurgeImportStmt",
		"RecoverTableStmt",
		"ReferOpt",
		"RegexpSym",
		"RenameTableStmt",
		"RenameUserStmt",
		"RepeatableOpt",
		"RestartStmt",
		"ResumeImportStmt",
		"revoke",
		"RevokeRoleStmt",
		"RevokeStmt",
		"RoleOrPrivElemList",
		"RoleSpec",
		"SelectStmtOpt",
		"SelectStmtSQLCache",
		"SetBindingStmt",
		"SetDefaultRoleOpt",
		"SetDefaultRoleStmt",
		"SetRoleStmt",
		"ShowImportStmt",
		"ShowProfileType",
		"ShowStmt",
		"ShowTableAliasOpt",
		"ShutdownStmt",
		"SignedLiteral",
		"SplitOption",
		"SplitRegionStmt",
		"Statement",
		"StatsOptionsOpt",
		"StatsPersistentVal",
		"StatsType",
		"StopImportStmt",
		"SubPartDefinition",
		"SubPartitionMethod",
		"Symbol",
		"TableElementList",
		"TableLock",
		"TableNameListOpt",
		"TableOrTables",
		"TablesTerminalSym",
		"TableToTable",
		"Tenant",
		"TextStringList",
		"TraceStmt",
		"TruncateTableStmt",
		"UnlockTablesStmt",
		"UserToUser",
		"UseStmt",
		"Varchar",
		"VariableAssignmentList",
		"WhenClause",
		"WindowDefinition",
		"WindowFrameBound",
		"WindowSpec",
		"WithGrantOptionOpt",
		"WithList",
		"Writeable",
		"AdminShowSlow",
		"AlterOrderList",
		"AlterSequenceOptionList",
		"AlterTablePartitionOpt",
		"AlterTableSpecList",
		"AlterTableSpecListOpt",
		"AnalyzeOptionList",
		"AnyOrAll",
		"AsOfClauseOpt",
		"AsOpt",
		"AuthOption",
		"AuthPlugin",
		"BetweenOrNotOp",
		"BindingStatusType",
		"BitValueType",
		"BlobType",
		"BooleanType",
		"both",
		"CharsetNameOrDefault",
		"CharsetOpt",
		"ClearPasswordExpireOptions",
		"ColumnFormat",
		"ColumnList",
		"ColumnNameOrUserVariableList",
		"ColumnNameOrUserVarListOpt",
		"ColumnNameOrUserVarListOptWithBrackets",
		"ColumnSetValueList",
		"CompareOp",
		"ConnectionOptionList",
		"ConstraintElem",
		"CreateSequenceOptionListOpt",
		"CreateTableSelectOpt",
		"CreateViewSelectOpt",
		"DatabaseOptionListOpt",
		"DateAndTimeType",
		"DBNameList",
		"DefaultValueExpr",
		"dual",
		"ElseOpt",
		"EnforcedOrNotOrNotNullOpt",
		"ExplainFormatType",
		"ExpressionOpt",
		"FetchFirstOpt",
		"FieldAsName",
		"FieldAsNameOpt",
		"FieldItemList",
		"FieldList",
		"FirstOrNext",
		"FixedPointType",
		"FlashbackToNewName",
		"FloatingPointType",
		"FlushOption",
		"FromDual",
		"FulltextSearchModifierOpt",
		"FuncDatetimePrec",
		"GetFormatSelector",
		"HandleRangeList",
		"HavingClause",
		"IdentListWithParenOpt",
		"IfNotRunning",
		"IfRunning",
		"IgnoreLines",
		"ImportTruncate",
		"IndexHintScope",
		"IndexKeyTypeOpt",
		"IndexPartSpecificationListOpt",
		"IndexTypeOpt",
		"InOrNotOp",
		"InstanceOption",
		"IntegerType",
		"IsolationLevel",
		"IsOrNotOp",
		"leading",
		"LikeEscapeOpt",
		"LikeOrNotOp",
		"LikeTableWithOrWithoutParen",
		"LinesTerminated",
		"LoadDataSetList",
		"LoadDataSetSpecOpt",
		"LockType",
		"LogTypeOpt",
		"Match",
		"MatchOpt",
		"MaxIndexNumOpt",
		"MaxMinutesOpt",
		"NChar",
		"NumericType",
		"NVarchar",
		"OnDeleteUpdateOpt",
		"OnDuplicateKeyUpdate",
		"OptBinMod",
		"OptCharset",
		"OptErrors",
		"OptExistingWindowName",
		"OptFromFirstLast",
		"OptGConcatSeparator",
		"OptPartitionClause",
		"OptTable",
		"OptWindowFrameClause",
		"OptWindowOrderByClause",
		"Order",
		"OrReplace",
		"outfile",
		"PartDefValuesOpt",
		"PartitionKeyAlgorithmOpt",
		"PartitionMethod",
		"PartitionNumOpt",
		"PerDB",
		"PerTable",
		"precisionType",
		"PrepareSQL",
		"ProcedureCall",
		"recursive",
		"RegexpOrNotOp",
		"ReorganizePartitionRuleOpt",
		"RequireList",
		"RoleSpecList",
		"RowOrRows",
		"SelectStmtFieldList",
		"SelectStmtOpts",
		"SelectStmtOptsList",
		"SequenceOptionList",
		"SetOpr",
		"SetRoleOpt",
		"ShowIndexKwd",
		"ShowLikeOrWhereOpt",
		"ShowPlacementTarget",
		"ShowProfileArgsOpt",
		"ShowProfileTypes",
		"ShowProfileTypesOpt",
		"ShowTargetFilterable",
		"spatial",
		"SplitSyntaxOption",
		"ssl",
		"Start",
		"Starting",
		"starting",
		"StatementList",
		"StatementScope",
		"StorageMedia",
		"stored",
		"StringList",
		"StringNameOrBRIEOptionKeyword",
		"StringType",
		"SubPartDefinitionList",
		"SubPartDefinitionListOpt",
		"SubPartitionNumOpt",
		"SubPartitionOpt",
		"TableElementListOpt",
		"TableLockList",
		"TableRefsClause",
		"TableSampleMethodOpt",
		"TableSampleOpt",
		"TableSampleUnitOpt",
		"TableToTableList",
		"TextType",
		"trailing",
		"TriggerSym",
		"TrimDirection",
		"Type",
		"UserToUserList",
		"UserVariableList",
		"UsingRoles",
		"Values",
		"ValuesOpt",
		"ViewAlgorithm",
		"ViewCheckOption",
		"ViewDefiner",
		"ViewFieldList",
		"ViewName",
		"ViewSQLSecurity",
		"virtual",
		"VirtualOrStored",
		"WhenClauseList",
		"WindowClauseOptional",
		"WindowDefinitionList",
		"WindowFrameBetween",
		"WindowFrameExtent",
		"WindowFrameUnits",
		"WindowNameOrSpec",
		"WindowSpecDetails",
		"WithReadLockOpt",
		"WithValidation",
		"WithValidationOpt",
		"Year",
		"$default",
		"andnot",
		"AssignmentListOpt",
		"ColumnDefList",
		"CommaOpt",
		"createTableSelect",
		"empty",
		"error",
		"higherThanComma",
		"higherThanParenthese",
		"insertValues",
		"invalid",
		"lowerThanCharsetKwd",
		"lowerThanComma",
		"lowerThanCreateTableSelect",
		"lowerThanEq",
		"lowerThanFunction",
		"lowerThanInsertValues",
		"lowerThanKey",
		"lowerThanLocal",
		"lowerThanNot",
		"lowerThanOn",
		"lowerThanParenthese",
		"lowerThanRemove",
		"lowerThanSelectOpt",
		"lowerThanSelectStmt",
		"lowerThanSetKeyword",
		"lowerThanStringLitToken",
		"lowerThanValueKeyword",
		"lowerThenOrder",
		"neg",
		"odbcDateType",
		"odbcTimestampType",
		"odbcTimeType",
		"tableRefPriority",
	}

	for _, name := range yySymNames {
		if _, ok := xx[name]; ok {
			t.Log(name)
		}
	}

}

func TestCacheable(t *testing.T) {
	// test non-SelectStmt
	var stmt Node = &DeleteStmt{}
	require.False(t, IsReadOnly(stmt))

	stmt = &InsertStmt{}
	require.False(t, IsReadOnly(stmt))

	stmt = &UpdateStmt{}
	require.False(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{}
	require.True(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{}
	require.True(t, IsReadOnly(stmt))

	stmt = &DoStmt{}
	require.True(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{
		Stmt: &InsertStmt{},
	}
	require.True(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{
		Analyze: true,
		Stmt:    &InsertStmt{},
	}
	require.False(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{
		Stmt: &SelectStmt{},
	}
	require.True(t, IsReadOnly(stmt))

	stmt = &ExplainStmt{
		Analyze: true,
		Stmt:    &SelectStmt{},
	}
	require.True(t, IsReadOnly(stmt))

	stmt = &ShowStmt{}
	require.True(t, IsReadOnly(stmt))

	stmt = &ShowStmt{}
	require.True(t, IsReadOnly(stmt))
}

func TestUnionReadOnly(t *testing.T) {
	selectReadOnly := &SelectStmt{}
	selectForUpdate := &SelectStmt{
		LockInfo: &SelectLockInfo{LockType: SelectLockForUpdate},
	}
	selectForUpdateNoWait := &SelectStmt{
		LockInfo: &SelectLockInfo{LockType: SelectLockForUpdateNoWait},
	}

	setOprStmt := &SetOprStmt{
		SelectList: &SetOprSelectList{
			Selects: []Node{selectReadOnly, selectReadOnly},
		},
	}
	require.True(t, IsReadOnly(setOprStmt))

	setOprStmt.SelectList.Selects = []Node{selectReadOnly, selectReadOnly, selectReadOnly}
	require.True(t, IsReadOnly(setOprStmt))

	setOprStmt.SelectList.Selects = []Node{selectReadOnly, selectForUpdate}
	require.False(t, IsReadOnly(setOprStmt))

	setOprStmt.SelectList.Selects = []Node{selectReadOnly, selectForUpdateNoWait}
	require.False(t, IsReadOnly(setOprStmt))

	setOprStmt.SelectList.Selects = []Node{selectForUpdate, selectForUpdateNoWait}
	require.False(t, IsReadOnly(setOprStmt))

	setOprStmt.SelectList.Selects = []Node{selectReadOnly, selectForUpdate, selectForUpdateNoWait}
	require.False(t, IsReadOnly(setOprStmt))
}

// CleanNodeText set the text of node and all child node empty.
// For test only.
func CleanNodeText(node Node) {
	var cleaner nodeTextCleaner
	node.Accept(&cleaner)
}

// nodeTextCleaner clean the text of a node and it's child node.
// For test only.
type nodeTextCleaner struct {
}

// Enter implements Visitor interface.
func (checker *nodeTextCleaner) Enter(in Node) (out Node, skipChildren bool) {
	in.SetText(nil, "")
	in.SetOriginTextPosition(0)
	switch node := in.(type) {
	case *Constraint:
		if node.Option != nil {
			if node.Option.KeyBlockSize == 0x0 && node.Option.Tp == 0 && node.Option.Comment == "" {
				node.Option = nil
			}
		}
	case *FuncCallExpr:
		node.FnName.O = strings.ToLower(node.FnName.O)
		switch node.FnName.L {
		case "convert":
			node.Args[1].(*test_driver.ValueExpr).Datum.SetBytes(nil)
		}
	case *AggregateFuncExpr:
		node.F = strings.ToLower(node.F)
	case *FieldList:
		for _, f := range node.Fields {
			f.Offset = 0
		}
	case *AlterTableSpec:
		for _, opt := range node.Options {
			opt.StrValue = strings.ToLower(opt.StrValue)
		}
	case *Join:
		node.ExplicitParens = false
	case *ColumnDef:
		node.Tp.CleanElemIsBinaryLit()
	}
	return in, false
}

// Leave implements Visitor interface.
func (checker *nodeTextCleaner) Leave(in Node) (out Node, ok bool) {
	return in, true
}

type NodeRestoreTestCase struct {
	sourceSQL string
	expectSQL string
}

func runNodeRestoreTest(t *testing.T, nodeTestCases []NodeRestoreTestCase, template string, extractNodeFunc func(node Node) Node) {
	runNodeRestoreTestWithFlags(t, nodeTestCases, template, extractNodeFunc, DefaultRestoreFlags)
}

func runNodeRestoreTestWithFlags(t *testing.T, nodeTestCases []NodeRestoreTestCase, template string, extractNodeFunc func(node Node) Node, flags RestoreFlags) {
	p := parser.New()
	p.EnableWindowFunc(true)
	for _, testCase := range nodeTestCases {
		sourceSQL := fmt.Sprintf(template, testCase.sourceSQL)
		expectSQL := fmt.Sprintf(template, testCase.expectSQL)
		stmt, err := p.ParseOneStmt(sourceSQL, "", "")
		comment := fmt.Sprintf("source %#v", testCase)
		require.NoError(t, err, comment)
		var sb strings.Builder
		err = extractNodeFunc(stmt).Restore(NewRestoreCtx(flags, &sb))
		require.NoError(t, err, comment)
		restoreSql := fmt.Sprintf(template, sb.String())
		comment = fmt.Sprintf("source %#v; restore %v", testCase, restoreSql)
		require.Equal(t, expectSQL, restoreSql, comment)
		stmt2, err := p.ParseOneStmt(restoreSql, "", "")
		require.NoError(t, err, comment)
		CleanNodeText(stmt)
		CleanNodeText(stmt2)
		require.Equal(t, stmt, stmt2, comment)
	}
}

// runNodeRestoreTestWithFlagsStmtChange likes runNodeRestoreTestWithFlags but not check if the ASTs are same.
// Sometimes the AST are different and it's expected.
func runNodeRestoreTestWithFlagsStmtChange(t *testing.T, nodeTestCases []NodeRestoreTestCase, template string, extractNodeFunc func(node Node) Node, flags RestoreFlags) {
	p := parser.New()
	p.EnableWindowFunc(true)
	for _, testCase := range nodeTestCases {
		sourceSQL := fmt.Sprintf(template, testCase.sourceSQL)
		expectSQL := fmt.Sprintf(template, testCase.expectSQL)
		stmt, err := p.ParseOneStmt(sourceSQL, "", "")
		comment := fmt.Sprintf("source %#v", testCase)
		require.NoError(t, err, comment)
		var sb strings.Builder
		err = extractNodeFunc(stmt).Restore(NewRestoreCtx(flags, &sb))
		require.NoError(t, err, comment)
		restoreSql := fmt.Sprintf(template, sb.String())
		comment = fmt.Sprintf("source %#v; restore %v", testCase, restoreSql)
		require.Equal(t, expectSQL, restoreSql, comment)
	}
}
